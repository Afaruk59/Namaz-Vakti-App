<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Hakikat Kitabevi - Kitaplık</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <link rel="stylesheet" charset="utf-8" type="text/css" href="https://www.hakikatkitabevi.net/scpublic/themes/default/style.css"/>
        <link rel="stylesheet" type="text/css" href="https://www.hakikatkitabevi.net/public.css"/>
        <script language="javascript" charset="utf-8" type="text/javascript" src="https://www.hakikatkitabevi.net/scpublic/scripts/public.js"></script>
        <script language="javascript" charset="utf-8" type="text/javascript" src="https://www.hakikatkitabevi.net/scpublic/languages/public-tr.js"></script>
        <script language="javascript" charset="utf-8" type="text/javascript">
            SC_SID = '0';
            SC_LID = '0';
            SC_LANG = 'tr';
            SC_LIB = '/scpublic';
            SCDateFormat = 'd.m.Y';
            SCCurrFormat = {
                decimalSymbol: ',',
                thousandSymbol: '.',
                decimalCount: '2',
                moneySymbol: ''
            };
        </script>
        <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
        <script>
            // URL parametresinden dili al
            function getUrlParameter(name) {
                name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
                var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
                var results = regex.exec(location.search);
                return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
            }
            
            // Mevcut dil
            var currentLang = getUrlParameter('lang') || 'en';
            
            // Dil değiştirme fonksiyonu
            function changeLanguage(lang) {
                window.location.href = '?lang=' + lang;
            }
            
            // Dinamik kitap yükleme için cache
            var booksCache = {};
            
            // CORS problemini çözmek için farklı yöntemler
            function loadBooksWithCORS(url, lang) {
                // Önce fetch dene
                fetch(url, {
                    mode: 'cors',
                    headers: {
                        'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'
                    }
                })
                .then(response => {
                    if (response.ok) {
                        return response.text();
                    }
                    throw new Error('Network response was not ok');
                })
                .then(html => {
                    console.log('HTML loaded for language:', lang);
                    var books = parseBooksFromHTML(html);
                    booksCache[lang] = books;
                    displayBooks(books, lang);
                })
                .catch(error => {
                    console.log('Fetch failed, trying iframe method:', error);
                    loadBooksWithIframe(url, lang);
                });
            }
            
            // Iframe ile veri çekme (CORS bypass)
            function loadBooksWithIframe(url, lang) {
                var iframe = document.createElement('iframe');
                iframe.style.display = 'none';
                iframe.src = url;
                document.body.appendChild(iframe);
                
                iframe.onload = function() {
                    try {
                        var iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                        var books = parseBooksFromHTML(iframeDoc.documentElement.outerHTML);
                        booksCache[lang] = books;
                        displayBooks(books, lang);
                    } catch (e) {
                        console.log('Iframe method failed, using fallback:', e);
                        loadBooksWithFallback(lang);
                    }
                    document.body.removeChild(iframe);
                };
                
                iframe.onerror = function() {
                    console.log('Iframe load failed, using fallback');
                    loadBooksWithFallback(lang);
                    document.body.removeChild(iframe);
                };
            }
            
            // Fallback: Bilinen kitap kodları ile dene
            function loadBooksWithFallback(lang) {
                // Bilinen kitap kodları (sadece örnek)
                var fallbackBooks = {
                    'tr': [
                        {code: '001', title: 'Tam İlmihâl Se`âdet-i Ebediyye'},
                        {code: '002', title: 'Mektûbat Tercemesi'},
                        {code: '008', title: 'Fâideli Bilgiler'},
                        {code: '009', title: 'Hak Sözün Vesîkaları'},
                        {code: '010', title: 'Herkese Lâzım Olan Îmân'},
                        {code: '003', title: 'İslâm Ahlâkı'},
                        {code: '007', title: 'Eshâb-ı Kirâm'},
                        {code: '004', title: 'Kıyâmet ve Âhıret'},
                        {code: '006', title: 'Cevâb Veremedi'},
                        {code: '011', title: 'İngiliz Câsûsunun İ`tirâfları'},
                        {code: '012', title: 'Kıymetsiz Yazılar'},
                        {code: '005', title: 'Namâz Kitâbı'},
                        {code: '014', title: 'Şevâhid-ün Nübüvve'},
                        {code: '013', title: 'Menâkıb-ı Çihâr Yâr-i Güzîn'},
                        {code: '129', title: 'Dürr-ül me\'ârif'},
                        {code: '132', title: 'El-münkızü mined-dalâl'},
                        {code: '133', title: 'Mahzen-ül-ulûm'}
                    ],
                    'en': [
                        {code: '025', title: 'Seâdet-i Ebediyye Endless Bliss First Fascicle'},
                        {code: '026', title: 'Seâdet-i Ebediyye Endless Bliss Second Fascicle'},
                        {code: '027', title: 'Seâdet-i Ebediyye Endless Bliss Third Fascicle'},
                        {code: '028', title: 'Seâdet-i Ebediyye Endless Bliss Fourth Fascicle'},
                        {code: '029', title: 'Seâdet-i Ebediyye Endless Bliss Fifth Fascicle'},
                        {code: '030', title: 'Seâdet-i Ebediyye Endless Bliss Sixth Fascicle'},
                        {code: '032', title: 'The Sunni Path'},
                        {code: '017', title: 'Belief and Islam'},
                        {code: '031', title: 'The Proof of Prophethood'},
                        {code: '016', title: 'Answer to an Enemy of Islam'},
                        {code: '015', title: 'Advice for the Muslim'},
                        {code: '022', title: 'Islam and Christianity'},
                        {code: '019', title: 'Could Not Answer'},
                        {code: '018', title: 'Confessions of a British Spy and British Enmity Against Islam'},
                        {code: '020', title: 'Documents of the Right Word'},
                        {code: '021', title: 'Ethics of Islam'},
                        {code: '024', title: 'Sahaba \'The Blessed\''},
                        {code: '023', title: 'Islam\'s Reformers'},
                        {code: '127', title: 'The Rising and the Hereafter'},
                        {code: '057', title: 'Miftah-ul-Janna (Booklet for way to Paradise)'},
                        {code: '312', title: 'Muslim Ritual Prayers (Kitab as-salat)'},
                        {code: '191', title: 'O Son'}
                    ],
                    'de': [
                        {code: '322', title: 'Die ewige Glückseligkeit'},
                        {code: '307', title: 'BEWEISE FÜR DAS PROPHETENTUM'},
                        {code: '244', title: 'DAS GEBETSBUCH'},
                        {code: '293', title: 'ISLAMISCHE ETHIK'},
                        {code: '034', title: 'GLAUBE UND ISLAM'},
                        {code: '037', title: 'ISLAM UND CHRISTENTUM'},
                        {code: '039', title: 'GESTÄNDNISSE EINES BRITISCHEN SPIONS'},
                        {code: '284', title: 'DER WEG DER AHLUS-SUNNA'},
                        {code: '285', title: 'DIE EDLEN GEFÄHRTEN'},
                        {code: '286', title: 'BELEGE FÜR DAS WAHRE WORT'},
                        {code: '294', title: 'DER JÜNGSTE TAG UND DAS JENSEITS'}
                    ],
                    'es': [
                        {code: '051', title: 'Creencia e Islam'},
                        {code: '223', title: 'LIBRO DEL NAMÂZ'}
                    ],
                    'it': [
                        {code: '224', title: 'ÎMÂN E ISLÂM'}
                    ],
                    'fr': [
                        {code: '308', title: 'La Résurrection et l\'Au-delà'},
                        {code: '325', title: 'L\'Éthique Islamique'},
                        {code: '047', title: 'Foi et Islam'},
                        {code: '305', title: 'La Voie d\' Ahlus-Sunna'},
                        {code: '306', title: 'LES CONFESSIONS DE L\'ESPION BRITANNIQUE'},
                        {code: '323', title: 'ISLAM et CHRISTIANISME'},
                        {code: '270', title: 'LIVRE DE LA PRIÈRE'},
                        {code: '046', title: 'L\'évidence de la Prophétie'},
                        {code: '049', title: 'Ar-radd al Jamil'},
                        {code: '048', title: 'Al-Munqid Min Addalâl'}
                    ],
                    'ar': [
                        {code: '287', title: 'الِفبا'},
                        {code: '282', title: 'البهجة السنية'},
                        {code: '056', title: '٦- الايمان والإسلام'},
                        {code: '176', title: '٧- نخبة اللآلي لشرح بدء الأمالي'},
                        {code: '153', title: '٨- الحديقة الندية شرح الطريقة المحمدية'},
                        {code: '163', title: '٩- علماء المسلمين وجهلة الوهابيين'},
                        {code: '155', title: '١٠- فتاوى الحرمين'},
                        {code: '156', title: '١١- هدية المهديين'},
                        {code: '173', title: '١٢- المنقذ من الضلال ويليه إلجام العوام'},
                        {code: '143', title: '١٣- المنتخبات من المكتوبات للإمام الرّباني'},
                        {code: '172', title: '١٤- مختصر (التحفة الاثنى عشرية)'},
                        {code: '175', title: '١٥- الناهية عن طعن امير المؤمنين معاوية'},
                        {code: '158', title: '١٦- خلاصة التحقيق في بيان حكم التقليد والتلفيق'},
                        {code: '170', title: '١٧- المنحة الوهبية في ردّ الوهابية'},
                        {code: '236', title: '١٨- البصائر لمنكري التوسل باهل المقابر'},
                        {code: '151', title: '١٩- فتنة الوهابية والصواعق الالهية'},
                        {code: '181', title: '٢٠- تطهير الفؤاد ويليه شفاء السقام'},
                        {code: '147', title: '٢١- الفجر الصادق في الرد على منكري التوسل...'},
                        {code: '152', title: '٢٢- الحبل المتين في إتباع السلف الصالحين'},
                        {code: '140', title: '٢٣- خلاصة الكلام في أمراء البلد الحرام لزيني دحلان'},
                        {code: '187', title: '٢٤- التوسل بالنبي وبالصالحين'},
                        {code: '141', title: '٢٥- الدرر السنية في الردّ على الوهابية'},
                        {code: '180', title: '٢٦- سبيل النجاة عن بدعة أهل الزيغ والضلالة'},
                        {code: '161', title: '٢٧- كتاب الإنصاف ويليه عقد الجيد'},
                        {code: '174', title: '٢٨- المستند المعتمد بناء نجاة الأبد'},
                        {code: '167', title: '٢٩- الاستاد المودودي ويليه كشف الشبهة'},
                        {code: '146', title: '٣٠- كتاب الأَيْمَان'},
                        {code: '148', title: '٣١- الفقه على المذاهب الأربعة ١'},
                        {code: '149', title: '٣٢- الفقه على المذاهب الأربعة ٢'},
                        {code: '150', title: '٣٣- الفقه على المذاهب الأربعة ٣'},
                        {code: '159', title: '٣٤- الادلة القواطع ويليه فتاوى علماء الهند على منع الخطبة'},
                        {code: '137', title: '٣٥- البريقة شرح الطريقة  ١'},
                        {code: '138', title: '٣٦- البريقة شرح الطريقة  ٢  ويليه منهل الواردين'},
                        {code: '320', title: 'المراح والعوامل'},
                        {code: '145', title: '٣٨- السعادة الأبدية فيما جاء به النقشبندية'},
                        {code: '169', title: '٣٩- مفتاح الفلاح ويليه خطبة عيد الفطر'},
                        {code: '183', title: '٤٠- مفاتيح الجنان شرح شرعة الإسلام'},
                        {code: '144', title: '٤١- الأنوار المحمدية من المواهب اللدنية'},
                        {code: '157', title: '٤٢- حجة الله على العالمين في معجزات سيد المرسلين'},
                        {code: '162', title: '٤٣- إثبات النبوة ويليه الدولة المكية بالمادة الغيبية'},
                        {code: '168', title: '٤٤- النعمة الكبرى على العالم في مولد سيد ولد آدم'},
                        {code: '186', title: '٤٥- تسهيل المنافع وبهامشه الطب النبوي'},
                        {code: '184', title: '٤٦- الدولة العثمانية من كتاب الفتوحات الإسلامية'},
                        {code: '237', title: '٤٧-كتاب الصلاة'},
                        {code: '179', title: '٤٩- الصواعق المحرقة في الردّ على أهل البدع والزندقة'},
                        {code: '154', title: '٥٠- الحقائق الإسلامية في الرد على المزاعم الوهابية'},
                        {code: '177', title: '٥١- نور الإسلام تأليف الشيخ عبد الكريم المدرس البغدادي'},
                        {code: '235', title: '٥٢-الصراط المستقيم في رد النصارى'},
                        {code: '178', title: '٥٣- الردّ الجميل في ردّ النصارى ويليه أيها الولد للغزالي'},
                        {code: '185', title: '٥٤- طريق النجاة ويليه المكتوبات المنتخبة لمحمد معصوم'},
                        {code: '164', title: '٥٥- القول الفصل شرح الفقه الأكبر للامام الاعظم'},
                        {code: '221', title: '٥٦- جاليةُ اْلأكدار'},
                        {code: '139', title: '٥٧- إعترافات الجاسوس الانكليزي'},
                        {code: '182', title: '٥٨- غاية التحقيق ونهاية التدقيق للشيخ السندي'},
                        {code: '166', title: '٥٩- المعلومات النافعة لأحمد جودت باشا'},
                        {code: '171', title: '٦٠- مصباح الأنام وجلاء الظلام في ردّ شبه البدعي'},
                        {code: '160', title: '٦١- إبتغاء الوصول لحب الله بمدح الرسول'},
                        {code: '142', title: '٦٢- الاسلام وسائر الأديان'},
                        {code: '165', title: '٦٣- مختصر تذكرة القرطبي للإستاذ عبد الوهاب الشعراني'}
                    ]
                };
                
                var books = fallbackBooks[lang] || [];
                booksCache[lang] = books;
                displayBooks(books, lang);
            }
            
            // Dinamik kitap yükleme fonksiyonu
            function loadBooks(lang) {
                // Önce loading göster
                var loadingText = 'Kitaplar yükleniyor...';
                if (lang === 'ar') loadingText = 'جاري تحميل الكتب...';
                else if (lang === 'fr') loadingText = 'Chargement des livres...';
                else if (lang === 'de') loadingText = 'Bücher werden geladen...';
                else if (lang === 'en') loadingText = 'Loading books...';
                else if (lang === 'es') loadingText = 'Cargando libros...';
                else if (lang === 'it') loadingText = 'Caricamento libri...';
                
                document.getElementById('bookshelf-content').innerHTML = '<div style="text-align:center; padding:50px; color:#fff;">' + loadingText + '</div>';
                
                // Cache'de varsa kullan
                if (booksCache[lang]) {
                    displayBooks(booksCache[lang], lang);
                    return;
                }
                
                // Gerçek siteden kitap verilerini çek
                var url = 'https://www.hakikatkitabevi.net/?listBook=' + lang;
                console.log('Loading books for language:', lang, 'URL:', url);
                
                // CORS problemi olabileceği için farklı yöntemler dene
                loadBooksWithCORS(url, lang);
            }
            
            // HTML'den kitap verilerini parse et
            function parseBooksFromHTML(html) {
                var books = [];
                var parser = new DOMParser();
                var doc = parser.parseFromString(html, 'text/html');
                
                // Farklı link formatlarını dene
                var selectors = [
                    'a[href*="book.php?bookCode="]',
                    'a[href*="bookCode="]',
                    'a[href*="book.php"]'
                ];
                
                var bookLinks = [];
                selectors.forEach(function(selector) {
                    var links = doc.querySelectorAll(selector);
                    bookLinks = bookLinks.concat(Array.from(links));
                });
                
                // Duplicate'leri kaldır
                var uniqueLinks = [];
                bookLinks.forEach(function(link) {
                    if (!uniqueLinks.some(function(existing) {
                        return existing.href === link.href;
                    })) {
                        uniqueLinks.push(link);
                    }
                });
                
                uniqueLinks.forEach(function(link) {
                    var href = link.getAttribute('href');
                    var title = link.getAttribute('title') || link.textContent.trim();
                    
                    // Farklı bookCode formatlarını dene
                    var patterns = [
                        /bookCode=(\d+)/,
                        /bookCode=([a-zA-Z0-9]+)/,
                        /book\.php\?.*?bookCode=(\d+)/,
                        /book\.php\?.*?bookCode=([a-zA-Z0-9]+)/
                    ];
                    
                    for (var i = 0; i < patterns.length; i++) {
                        var match = href.match(patterns[i]);
                        if (match) {
                            var code = match[1];
                            books.push({
                                code: code,
                                title: title
                            });
                            break;
                        }
                    }
                });
                
                // Eğer hiç kitap bulunamadıysa, img taglarından da dene
                if (books.length === 0) {
                    var bookImages = doc.querySelectorAll('img[src*="images/books/"]');
                    bookImages.forEach(function(img) {
                        var src = img.getAttribute('src');
                        var title = img.getAttribute('title') || img.getAttribute('alt') || '';
                        var match = src.match(/images\/books\/(\d+)\.png/);
                        if (match) {
                            books.push({
                                code: match[1],
                                title: title
                            });
                        }
                    });
                }
                
                console.log('Parsed books for language:', books.length, books);
                return books;
            }
            
            // Kitapları görüntüle
            function displayBooks(bookList, lang) {
                var html = '';
                
                if (bookList.length === 0) {
                    var noBooksText = 'Bu dilde kitap bulunamadı.';
                    if (lang === 'ar') noBooksText = 'لم يتم العثور على كتب بهذه اللغة.';
                    else if (lang === 'fr') noBooksText = 'Aucun livre trouvé dans cette langue.';
                    else if (lang === 'de') noBooksText = 'Keine Bücher in dieser Sprache gefunden.';
                    else if (lang === 'en') noBooksText = 'No books found in this language.';
                    else if (lang === 'es') noBooksText = 'No se encontraron libros en este idioma.';
                    else if (lang === 'it') noBooksText = 'Nessun libro trovato in questa lingua.';
                    
                    html = '<div style="text-align:center; padding:50px; color:#fff;">' + noBooksText + '</div>';
                } else {
                    // Kitapları 4'lü gruplar halinde düzenle
                    for (var i = 0; i < bookList.length; i += 4) {
                        html += '<div class="middle">';
                        for (var j = i; j < Math.min(i + 4, bookList.length); j++) {
                            var book = bookList[j];
                            var dirAttr = lang === 'ar' ? 'dir="rtl"' : 'dir=""';
                            html += '<a href="https://www.hakikatkitabevi.net/book.php?bookCode=' + book.code + '&listBook=' + lang + '" title="' + book.title + '" ' + dirAttr + '>';
                            html += '<img src="https://www.hakikatkitabevi.net/images/books/' + book.code + '.png" width="160" height="160" border="0" class="book"/>';
                            html += '</a>';
                        }
                        html += '<div style="clear:left;"></div></div>';
                    }
                }
                
                document.getElementById('bookshelf-content').innerHTML = html;
            }
            
            // Sayfa yüklendiğinde çalış
            $(document).ready(function() {
                loadBooks(currentLang);
                
                // Aktif dil butonunu işaretle
                $('.language-selector button').removeClass('active');
                $('.' + currentLang + '-btn').addClass('active');
            });
        </script>
        <style>
            body {
                margin: 0 !important;
                padding: 0 !important;
                background-color: transparent !important;
                background-image: none !important;
                font-family: Arial, sans-serif;
            }
            
            .container {
                max-width: 1000px;
                margin: 0 auto;
                background-color: transparent !important;
            }
            
            /* Sadece arka planları kaldır, rafı koru */
            #bookShelf {
                background-color: transparent !important;
            }
            
            .top, .bottom {
                background-color: transparent !important;
            }
            
            .top {
                background-image: url('https://www.hakikatkitabevi.net/images/site/bookshelf.png') !important;
                background-repeat: no-repeat !important;
                background-position: top center !important;
                height: 60px !important;
            }
            
            .middle {
                background-color: transparent !important;
            }
            
            /* Kitapları koru */
            .book {
                background-color: transparent !important;
            }
            
            .SelBookLang {
                position: absolute;
                display: none;
                width: 465px;
                left: 30px;
                top: 50px;
                background-color: #000;
                border: 1px solid #CCC;
                z-index: 10900;
                opacity: 0.80;
                padding: 15px 0px 20px 35px;
            }

            .SelBookLang.otherBookLang {
                width: 270px;
            }

            .langText {
                float: left;
                width: 195px;
                border-bottom: 1px dotted #666666;
                padding: 5px 0px 5px 0px;
                padding-right: 0;
                margin-right: 35px;
            }

            .langText.otherLangText {
                width: 100px;
            }

            .langText a {
                font-weight: bold;
                color: #fff;
                text-decoration: none;
            }

            .langText a:hover {
                color: #F60;
            }

            .lannng {
                color: #999;
                font-size: 12px;
                margin-left: 10px;
            }
            
            .language-selector {
                position: absolute;
                top: 20px;
                right: 20px;
                z-index: 1000;
            }
            
            .language-selector button {
                background: linear-gradient(to bottom, #8B4513, #654321);
                color: white;
                border: 2px solid #5D2F08;
                padding: 8px 15px;
                margin: 0 5px;
                border-radius: 5px;
                cursor: pointer;
                font-size: 14px;
                font-weight: bold;
            }
            
            .language-selector button:hover {
                background: linear-gradient(to bottom, #A0522D, #8B4513);
            }
            
            .language-selector button.active {
                background: linear-gradient(to bottom, #F60, #D2691E);
                border-color: #FF8C00;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div>
                <div id="bookShelf">
                    <div class="top">
                    </div>
                    <div class="middle" id="bookshelf-content">
                        <!-- Kitaplar JavaScript ile yüklenecek -->
                    </div>
                    <div class="bottom"></div>
                </div>
            </div>
        </div>

    </body>
</html>